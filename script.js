$(document).ready(function(){var e=[];function i(e,i){var t=document.getElementById("snackbar");t.innerHTML=e,t.className="show",setTimeout(function(){t.className=t.className.replace("show",""),i&&window.location.replace(i)},3e3)}function t(){document.body.scrollTop=0,document.documentElement.scrollTop=0}function n(e,i,t,n){var s="";if("button"==n){var a=`\n        <button onclick="window.open('${i}');" type="button" class="btn btn-secondary" id="u-${e}">\n            Download\n        </button>`;null!=i&&"uploading"!=i||(a=$(a).attr("disabled",!0)[0].outerHTML),s=`\n      <div class="row ${e}">\n\n        <div class="col-sm-4">${e}</div>\n        <div class="col-sm-4">${t}</div>\n        <div class="col-sm-4">\n        <div class="btn-group flt">\n          <div class="btn-group dropleft" role="group">\n            <button type="button" class="btn btn-secondary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id="d-${e}">\n              <span class="sr-only">Toggle Dropleft</span>\n            </button>\n            <div class="dropdown-menu" style="text-align: center;padding: .1rem 0;">\n              <button class="dropdown-item" id="r-${e}">refresh</button>\n            </div>\n          </div>\n          ${a}\n        </div>\n        </div>\n\n      </div>`}else s=`<li class="list-group-item list-group-item-warning">${e} : ${i}</li>`;return s}function s(e,a,o){var l=a;if(l.length<1&&i("not_set"),e>=l.length)$("#loading-mirror").hide(),$(".progress").remove(),console.log("end");else{var r=l[e];$.post("/post",{id:share_id,key:l[e]},function(i,s){if(1==i.error)t(),$(n(l[e],i.message.replace("new","processing"))).appendTo("#list-error").hide().fadeIn("slow");else if(0==i.error){if(o)$(n(l[e],i.status)).appendTo("#list-error").hide().fadeIn("slow"),$("#row").children().each(function(e,t){$(t).is(`.${r}`)&&($(`#row .row:nth-child(${e+1})`).replaceWith($(n(r,i.url,i.status,"button")).hide().fadeIn("slow")),console.log(e))});else $("#row").append(n(l[e],i.url,i.status,"button"));i.time&&($("#u-"+l[e]+", #d-"+l[e]).attr("disabled",!0),$("#u-"+l[e]).append(' <i class="fa fa-circle-o-notch fa-spin list-spinner"></i>'),setTimeout(function(){$("#u-"+l[e]+", #d-"+l[e]).attr("disabled",!1),$(".fa-spin").remove()},i.time))}else t(),$(n(l[e],i.message)).appendTo("#list-error").hide().fadeIn("slow")}).fail(function(i,s,a){t(),$(n(l[e],"failed")).appendTo("#list-error").hide().fadeIn("slow")}).always(function(){return o?s(e+1,a,o):s(e+1,a)})}}$("#signin").click(function(){$(this).append(' <i class="fa fa-circle-o-notch fa-spin list-spinner"></i>');var e=$("#email").val(),t=$("#password").val(),n=$("#captcha-response").val();$.post("/post",{email:e,password:t,token:n,key:"signin"},function(e,t){$(".fa-spin").remove(),1==e.error?e.redirect?i(e.message,e.redirect):i(e.message):i(e.message,e.redirect)})}),$("#signup").click(function(){$(this).append(' <i class="fa fa-circle-o-notch fa-spin list-spinner"></i>');var e=$("#password").val(),t=$("#confirm").val(),n=$("#code").val(),s=$("#key").val();$.post("/post",{password:e,confirm:t,code:n,key:s},function(e,t){$(".fa-spin").remove(),1==e.error?i(e.message):i(e.message,e.redirect)})}),$("#profile").click(function(){$(this).append(' <i class="fa fa-circle-o-notch fa-spin list-spinner"></i>');var e=$("#password").val(),t=$("#confirm").val();$.post("/post",{password:e,confirm:t,key:"profile"},function(e,t){$(".fa-spin").remove(),e.message&&i(e.message)})}),$("#button-export").click(function(){$(this).append(' <i class="fa fa-circle-o-notch fa-spin list-spinner"></i>');var e=$("#folders").val();$.post("/post",{id:e,key:"export_file"},function(e,t){if($(".fa-spin").remove(),1==e.error)i(e.message);else{var n=e.link,s="";n.forEach(function(e){s+=`<div class="list-item" drive="${e.id}"><img class="icon-list" src="https://drive-thirdparty.googleusercontent.com/16/type/application/"> <span class="list-name">${e.name}</span> <a href="#" class="list-close"><i class="fa fa-times" aria-hidden="true"></i></a></div>`}),$(".list-result").append(s)}})}),$("#link-upload").change(function(e){let i=$(this).val().split("\n").map(e=>{e=e.trim();let i={};try{i.id=e.match(/https?:\/\/(?:[\w\-]+\.)*(?:drive|docs)\.google\.com\/(?:(?:folderview|open|uc)\?(?:[\w\-\%]+=[\w\-\%]*&)*id=|(?:folder|file|document|presentation|spreadsheets)\/d\/|spreadsheet\/ccc\?(?:[\w\-\%]+=[\w\-\%]*&)*key=)([\w\-]{28,})/i)[1],i.link=e}catch(e){i=!1}if(i)return i}),t="";i.forEach(e=>{t+=`<div class="list-item" drive="${e.id}"><img class="icon-list" src="https://drive-thirdparty.googleusercontent.com/16/type/application/"> <span class="list-name">${e.link}</span> <a href="#" class="list-close"><i class="fa fa-times" aria-hidden="true"></i></a></div>`}),$(".list-result").append(t)}),$(".list-result").bind("DOMSubtreeModified",function(e){$(".list-close").click(function(e){$(this).parent().fadeOut(500).remove()})}),$("#btn-upload").click(function(){e=[],function t(n,s){var a=$(".list-item");if(a.length<1&&i("please add file to continue"),n>=a.length)console.log("end"),$("#btn-upload").attr("disabled",!1);else{var o=a[n],l=$(o),r=l.attr("drive");l.append(' <i class="fa fa-circle-o-notch fa-spin list-spinner"></i>'),$.post("/post",{id:r,key:s},function(i,t){l.children(".list-spinner").remove(),1==i.error?l.children(".list-name").html(`${i.message}`):l.children(".list-name").html(`<a href="${i.message}" target="_blank">${i.title}</a> <i class="fa fa-check"></i>`),a.length==n+1&&($(".embed").show(),$(".list-name a").each(function(){var i={link:this.href,title:this.childNodes[0].nodeValue};e.push(i)}),$("#links").trigger("click"))}).fail(function(e,i,t){l.children(".list-spinner").remove(),l.children(".list-name").html("Failed")}).always(function(){return t(n+1,s)})}}(0,$(this).attr("type")),$("#btn-upload").attr("disabled",!0),$(".embed").hide()}),$("#btn-zippyshare").click(function(){$(this).append(' <i class="fa fa-circle-o-notch fa-spin list-spinner"></i>'),$(this).attr("disabled",!0);var e=$(this).attr("id"),t=$(this).attr("fileID"),n=document.getElementById("captcha-response").value;$.post("/post",{id:t,token:n,key:"zippyshare"},function(t,n){1==t.error?($("#"+e).attr("disabled",!1),$(".fa-spin").remove(),i(t.message)):setTimeout(function(){$("#"+e).attr("disabled",!1),$(".fa-spin").remove(),window.open(t.url,"_blank"),window.location.reload()},t.time)})}),$("#btn-streamango, #btn-openload").click(function(){$(this).append(' <i class="fa fa-circle-o-notch fa-spin list-spinner"></i>'),$(this).attr("disabled",!0);var e=$(this).attr("id"),i=$(this).attr("URL");setTimeout(function(){$("#"+e).attr("disabled",!1),$(".fa-spin").remove(),window.open(i,"_blank")},3e3)}),$("#links").click(function(){return $("#results").html(""),$.each(e,function(e,i){$("#results").append(i.link+"<br />")}),!1}),$("#htmls").click(function(){return $("#results").html(""),$.each(e,function(e,i){$("#results").append('&lt;a href="'+i.link+'" title="'+i.title+'"&gt;'+i.title+"&lt;/a&gt;<br />")}),!1}),$("#forums").click(function(){return $("#results").html(""),$.each(e,function(e,i){$("#results").append("[URL="+i.link+"]"+i.title+"[/URL]<br />")}),!1}),$(document).on("click","#edit",function(){var e=$(this).attr("file-id"),i=$(this).attr("title");$("#show-edit-file").find("#title").val(i),$("#show-edit-file").find("#file-id").val(e),$("#show-edit-file").modal("show")}),$("#edit-file").click(function(e){$(this).append(' <i class="fa fa-circle-o-notch fa-spin list-spinner"></i>');var t=$("#show-edit-file").find("#file-id").val(),n=$("#show-edit-file").find("#title").val();$.post("/post",{id:t,title:n,key:"edit-file"},function(e,n){($(".fa-spin").remove(),1==e.error)?i(e.message):($("#show-edit-file").modal("hide"),document.getElementById(t).getElementsByTagName("td")[0].innerHTML='<a href="/file/'+t+'">'+e.message+"</a>")})}),$(document).on("click","#delete",function(){var e=$(this).attr("file-id");$("#show-delete").find("#file-id").val(e),$("#show-delete").modal("show")}),$("#delete-file").click(function(e){$(this).append(' <i class="fa fa-circle-o-notch fa-spin list-spinner"></i>');var t=$("#show-delete").find("#file-id").val();$("#show-delete").find("#key").val();$.post("/post",{id:t,key:"delete-file"},function(e,n){$(".fa-spin").remove(),1==e.error?i(e.message):($("#show-delete").modal("hide"),$("#"+t).fadeOut(500))})}),$("#checkall").click(function(){$(".checkfile").not(this).prop("checked",this.checked)}),$("#exportLinks").click(function(){var e="";$(".checkfile:checkbox:checked").each(function(i,t){e+=domain+$(this).parent().parent().find(".filename a").attr("href")+"\n"}),$("#exportedLinks").val(e),$(".modal-export-links").modal("show")}),$("#conf").click(function(e){$(this).append(' <i class="fa fa-circle-o-notch fa-spin list-spinner"></i>');var t,n,s,a=document.getElementById("config").querySelectorAll("[id]"),o=[],l=[];for(t=0;t<a.length;t++)({}),n=a[t].id,o.push(n),{},s=a[t].value,l.push(s);$.post("/post",{config:o,value:l,key:"config"},function(e,t){$(".fa-spin").remove(),e.message&&i(e.message,"/setting")})}),$("#ol").click(function(){$(this).append(' <i class="fa fa-circle-o-notch fa-spin list-spinner"></i>'),$(this).attr("disabled",!0),$.post("/post",{id:share_id,key:"original"},function(e,i){$("#ol").attr("disabled",!1),$(".fa-spin").remove(),1==e.error?(t(),$(n("original",e.message)).appendTo("#list-error").hide().fadeIn("slow")):0==e.error&&window.open(e.redirect,"_blank")}).fail(function(e,i,s){t(),$(n("original","failed")).appendTo("#list-error").hide().fadeIn("slow"),$("#ol").attr("disabled",!1),$(".fa-spin").remove()})}),$(document).on("click","#r-zippyshare, #r-verystream, #r-streamango, #r-openload, #r-multiup, #r-mirrorace",function(){var e=this.id.split("-")[1];$(`.${e} .col-sm-4:nth-child(1), .${e} .col-sm-4:nth-child(2), .${e} .col-sm-4:nth-child(3)`).html('<center><div class="spinner-grow spinner-grow-sm" role="status"><span class="sr-only">Loading...</span></div></center>'),$.post("/post",{id:share_id,key:e},function(i,s){1==i.error&&(t(),$(n(e,i.message.replace("new","processing"))).appendTo("#list-error").hide().fadeIn("slow").fadeOut(1e4)),$("#row").children().each(function(t,s){$(s).is(`.${e}`)&&($(`#row .row:nth-child(${t+1})`).replaceWith($(n(e,i.url,i.status,"button")).hide().fadeIn("slow")),console.log(t))}),i.time&&($(`#u-${e} , #d-${e}`).attr("disabled",!0),$(`#u-${e}`).append(' <i class="fa fa-circle-o-notch fa-spin list-spinner"></i>'),setTimeout(function(){$(`#u-${e} , #d-${e}`).attr("disabled",!1),$(".fa-spin").remove()},i.time))})}),"file"==window.location.pathname.split("/")[1]&&($("#loading-mirror").show(),$("#loading-mirror").append('<div class="progress" style="width: 100%;"><div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="0" style="width: 100%">please wait..</div></div>'),s(0,host)),$("#example").DataTable({searching:!0,paging:!1,info:!1,order:[],columnDefs:[{targets:"no-sort",orderable:!1}]})});